# Stronghold Environment Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# REQUIRED: Database Configuration
# =============================================================================

# PostgreSQL connection settings
DB_HOST=localhost
DB_PORT=5432
DB_USER=stronghold
DB_PASSWORD=change_me_in_production
DB_NAME=stronghold
DB_SSLMODE=require

# For Docker Compose, use these instead:
# DB_HOST=postgres
# DB_SSLMODE=disable

# =============================================================================
# REQUIRED: JWT Authentication
# =============================================================================

# Generate a strong random secret (at least 32 characters)
# Example: openssl rand -base64 32
JWT_SECRET=your_super_secret_jwt_key_change_this_in_production

# Token lifetimes (Go duration format)
ACCESS_TOKEN_TTL=15m
REFRESH_TOKEN_TTL=2160h

# =============================================================================
# REQUIRED: Dashboard Configuration
# =============================================================================

# URL where the dashboard is hosted
DASHBOARD_URL=http://localhost:3000

# Comma-separated list of allowed origins for CORS
DASHBOARD_ALLOWED_ORIGINS=http://localhost:3000,https://getstronghold.xyz

# =============================================================================
# REQUIRED: x402 Payment Configuration
# =============================================================================

# EVM wallet address for receiving payments on Base (0x...)
X402_EVM_WALLET_ADDRESS=0x...

# Solana wallet address for receiving payments (base58)
# Set this to enable Solana payments alongside Base
X402_SOLANA_WALLET_ADDRESS=

# x402 facilitator URL (self-hosted x402-rs on Fly.io)
# For local dev with docker-compose, this defaults to http://x402-facilitator:8402
# For production on Fly.io, use internal networking:
#   X402_FACILITATOR_URL=http://stronghold-facilitator.internal:8402
X402_FACILITATOR_URL=http://localhost:8402

# Supported payment networks (comma-separated)
# Available: base, base-sepolia, solana, solana-devnet
# Example production: base,solana
# Example testnet:    base-sepolia,solana-devnet
X402_NETWORKS=base,solana

# Solana fee payer: the facilitator's Solana public key
# When set, the API includes this in 402 responses so clients use the
# facilitator as the transaction fee payer (users don't need SOL for fees)
X402_SOLANA_FEE_PAYER=

# =============================================================================
# REQUIRED: Self-Hosted x402 Facilitator Configuration
# =============================================================================
# The facilitator settles x402 payments on-chain. It needs a funded wallet
# and RPC endpoints for the target chains.

# Private key for the EVM facilitator wallet (must be funded with ETH for gas)
# Generate: cast wallet new
# Fund with ~0.01 ETH on Base (~$25, lasts ~90k settlements)
FACILITATOR_EVM_PRIVATE_KEY=0x...

# Private key for the Solana facilitator wallet (must be funded with SOL for fees)
# Generate: solana-keygen new
# Fund with ~0.1 SOL for transaction fees
# Format: base58-encoded private key
FACILITATOR_SOLANA_PRIVATE_KEY=

# RPC URLs - EVM (Alchemy free tier: 30M CU/month, sufficient for ~150k settlements)
# Create apps at: https://dashboard.alchemy.com/
RPC_URL_BASE=https://base-mainnet.g.alchemy.com/v2/YOUR_KEY
RPC_URL_BASE_SEPOLIA=https://base-sepolia.g.alchemy.com/v2/YOUR_KEY

# RPC URLs - Solana (Helius/QuickNode/Alchemy)
# Create apps at: https://www.helius.dev/ or https://dashboard.alchemy.com/
RPC_URL_SOLANA=https://mainnet.helius-rpc.com/?api-key=YOUR_KEY
RPC_URL_SOLANA_DEVNET=https://devnet.helius-rpc.com/?api-key=YOUR_KEY


# =============================================================================
# REQUIRED (production): Stripe Crypto Onramp Configuration
# =============================================================================
# Get these from your Stripe dashboard: https://dashboard.stripe.com/apikeys
# Webhook secret from: https://dashboard.stripe.com/webhooks

STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
STRIPE_PUBLISHABLE_KEY=pk_test_...

# =============================================================================
# OPTIONAL: Stronghold Scanner Configuration
# =============================================================================

# Thresholds for threat detection (0.0 to 1.0)
STRONGHOLD_BLOCK_THRESHOLD=0.55
STRONGHOLD_WARN_THRESHOLD=0.35

# Enable/disable detection modules
STRONGHOLD_ENABLE_HUGOT=true
STRONGHOLD_ENABLE_SEMANTICS=true

# Path to Hugging Face models
HUGOT_MODEL_PATH=./models

# Optional: LLM-based detection provider (openai, anthropic)
STRONGHOLD_LLM_PROVIDER=
STRONGHOLD_LLM_API_KEY=

# =============================================================================
# OPTIONAL: Server Configuration
# =============================================================================

PORT=8080
SERVER_READ_TIMEOUT=10s
SERVER_WRITE_TIMEOUT=30s

# =============================================================================
# OPTIONAL: Pricing Configuration (USD per request)
# =============================================================================

PRICE_SCAN_CONTENT=0.001
PRICE_SCAN_OUTPUT=0.001

# =============================================================================
# REQUIRED (production): AWS KMS Configuration
# =============================================================================
# KMS is used to encrypt wallet private keys for cross-device access
# In development, KMS is optional - wallets are created locally

# AWS Region where your KMS key is located
KMS_REGION=us-east-1

# KMS Key ID - can be key ARN or alias
# Example: alias/stronghold-wallet-keys
# Example: arn:aws:kms:us-east-1:123456789:key/1234-5678-...
KMS_KEY_ID=alias/stronghold-wallet-keys

# =============================================================================
# DEVELOPMENT ONLY
# =============================================================================

# Set to 'true' to skip payment requirements in development
# DEV_SKIP_PAYMENTS=false

# Set to 'true' to enable debug logging
# DEBUG=false

# =============================================================================
# E2E Testing (cmd/x402test/e2e.go)
# =============================================================================

# EVM private key (hex) for E2E payment tests
# TEST_PRIVATE_KEY=0x...

# Solana private key (base58) for E2E payment tests
# TEST_SOLANA_PRIVATE_KEY=...

# Solana RPC URL for E2E tests (defaults to public devnet RPC)
# SOLANA_RPC_URL=https://devnet.helius-rpc.com/?api-key=YOUR_KEY
